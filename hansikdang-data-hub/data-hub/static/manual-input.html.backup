<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ë™ ì…ë ¥ - í•œì‹ë‹¹ Data Hub</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 240px;
            height: 100vh;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }

        .sidebar-header h2 {
            margin: 0 0 5px 0;
            font-size: 18px;
            color: #fff;
        }

        .sidebar-header p {
            margin: 0;
            font-size: 12px;
            color: #bdc3c7;
        }

        .menu-group {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .menu-label {
            padding: 10px 20px;
            font-size: 11px;
            font-weight: 600;
            color: #95a5a6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .menu-item {
            display: block;
            padding: 12px 20px;
            color: #ecf0f1;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 14px;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: #3498db;
            padding-left: 25px;
        }

        .menu-item.active {
            background: rgba(52, 152, 219, 0.2);
            border-left-color: #3498db;
            font-weight: 600;
        }

        .main-content {
            margin-left: 260px;
            min-height: 100vh;
            padding: 30px;
        }

        .header {
            background: white;
            padding: 25px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2rem;
            color: #2c3e50;
            margin: 0 0 5px 0;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 0.95rem;
        }

        .tabs {
            display: flex;
            gap: 10px;
            background: white;
            padding: 15px 20px 0 20px;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: #7f8c8d;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            background: white;
            padding: 30px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .sub-tabs {
            display: flex;
            gap: 5px;
            background: #f7fafc;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .sub-tab {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: #666;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .sub-tab:hover {
            background: #e2e8f0;
        }

        .sub-tab.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .form-label .required {
            color: #f56565;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .upload-area {
            border: 3px dashed #d1d5db;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: #e7f3ff;
        }

        .file-input {
            display: none;
        }

        .preview-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }

        .preview-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .preview-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .preview-item:last-child {
            border-bottom: none;
        }

        .preview-label {
            color: #7f8c8d;
            font-size: 13px;
        }

        .preview-value {
            color: #2c3e50;
            font-weight: 600;
            font-size: 13px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .table-container {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }

        .csv-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .csv-table thead {
            position: sticky;
            top: 0;
            background: #f8f9fa;
            z-index: 10;
        }

        .csv-table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border-bottom: 2px solid #e9ecef;
        }

        .csv-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #f1f3f5;
        }

        .csv-table tbody tr:hover {
            background: #f8f9fa;
        }

        .spinner {
            border: 3px solid #ecf0f1;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: #f7fafc;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #2c3e50;
        }

        .checkbox-label:hover {
            background: #e2e8f0;
        }

        .checkbox-input {
            cursor: pointer;
        }

        .menu-item-card, .hour-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            position: relative;
        }

        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f56565;
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }

        .add-btn {
            background: #48bb78;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-btn:hover {
            background: #38a169;
        }

        .image-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .image-item {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .image-item input {
            flex: 1;
        }

        .image-item button {
            width: 80px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>í•œì‹ë‹¹ Data Hub</h2>
                <p>Restaurant Data Collection</p>
            </div>

            <div class="menu-group">
                <div class="menu-label">ëŒ€ì‹œë³´ë“œ</div>
                <a href="/dashboard" class="menu-item">ğŸ“Š ë©”ì¸ ëŒ€ì‹œë³´ë“œ</a>
            </div>

            <div class="menu-group">
                <div class="menu-label">ë°ì´í„° ìˆ˜ì§‘</div>
                <a href="/dashboard/collection-request" class="menu-item">ğŸ“ ìˆ˜ì§‘ ìš”ì²­</a>
                <a href="/dashboard/collection-results" class="menu-item">ğŸ“‹ ìˆ˜ì§‘ ê²°ê³¼</a>
            </div>

            <div class="menu-group">
                <div class="menu-label">ë°ì´í„° ì…ë ¥</div>
                <a href="/dashboard/manual-input#url" class="menu-item active">ğŸ”— URL ì…ë ¥</a>
                <a href="/dashboard/manual-input#csv" class="menu-item">ğŸ“„ CSV ì—…ë¡œë“œ</a>
                <a href="/dashboard/manual-input#direct" class="menu-item">âœï¸ ì§ì ‘ ì…ë ¥</a>
            </div>

            <div class="menu-group">
                <div class="menu-label">ë°ì´í„° í¸ì§‘</div>
                <a href="/dashboard/unified-editor" class="menu-item">ğŸ”§ í†µí•© í¸ì§‘</a>
            </div>

            <div class="menu-group">
                <div class="menu-label">ë°°í¬ ê´€ë¦¬</div>
                <a href="/dashboard/deployment" class="menu-item">ğŸš€ ë°°í¬ ê´€ë¦¬</a>
            </div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>âœï¸ ìˆ˜ë™ ì…ë ¥</h1>
                <p class="subtitle">URL íŒŒì‹±, CSV ì—…ë¡œë“œ, ì§ì ‘ ì…ë ¥ì„ í†µí•´ ë ˆìŠ¤í† ë‘ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤</p>
            </div>

            <div v-if="alert.show" :class="['alert', alert.type]">
                <span>{{ alert.message }}</span>
                <button @click="alert.show = false" style="margin-left: auto; background: none; border: none; cursor: pointer; font-size: 18px;">Ã—</button>
            </div>

            <div class="tabs">
                <button class="tab" :class="{ active: activeTab === 'url' }" @click="activeTab = 'url'">
                    ğŸ”— URL íŒŒì‹±
                </button>
                <button class="tab" :class="{ active: activeTab === 'csv' }" @click="activeTab = 'csv'">
                    ğŸ“‚ CSV ì—…ë¡œë“œ
                </button>
                <button class="tab" :class="{ active: activeTab === 'direct' }" @click="activeTab = 'direct'">
                    âœï¸ ì§ì ‘ ì…ë ¥
                </button>
            </div>

            <div class="tab-content">
                <div v-if="activeTab === 'url'">
                    <h3 style="margin-bottom: 20px;">ë„¤ì´ë²„/êµ¬ê¸€/ì¹´ì¹´ì˜¤ URLì—ì„œ ë ˆìŠ¤í† ë‘ ì •ë³´ ì¶”ì¶œ</h3>
                    
                    <div class="form-group">
                        <label class="form-label">ë ˆìŠ¤í† ë‘ URL</label>
                        <input type="text" class="form-input" v-model="urlForm.url" 
                               placeholder="ì˜ˆ: https://map.naver.com/place/12345678">
                        <p style="color: #7f8c8d; font-size: 12px; margin-top: 5px;">
                            ì§€ì›: ë„¤ì´ë²„í”Œë ˆì´ìŠ¤, êµ¬ê¸€ë§µìŠ¤, ì¹´ì¹´ì˜¤ë§µ
                        </p>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" @click="parseURL" :disabled="loading">
                            ğŸ” URL ë¶„ì„
                        </button>
                        <button class="btn btn-success" @click="saveFromURL" :disabled="!urlPreview || loading">
                            ğŸ’¾ ì €ì¥í•˜ê¸°
                        </button>
                    </div>

                    <div v-if="loading" class="spinner"></div>

                    <div v-if="urlPreview" class="preview-card">
                        <div class="preview-title">âœ… URL íŒŒì‹± ì™„ë£Œ</div>
                        <div class="preview-item">
                            <span class="preview-label">ë ˆìŠ¤í† ë‘ ì´ë¦„:</span>
                            <span class="preview-value">{{ urlPreview.name }}</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">ì£¼ì†Œ:</span>
                            <span class="preview-value">{{ urlPreview.address }}</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">ì¶œì²˜:</span>
                            <span class="preview-value">{{ urlPreview.source.toUpperCase() }}</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">Place ID:</span>
                            <span class="preview-value">{{ urlPreview.place_id || 'N/A' }}</span>
                        </div>
                    </div>
                </div>

                <div v-if="activeTab === 'csv'">
                    <h3 style="margin-bottom: 20px;">CSV íŒŒì¼ ì—…ë¡œë“œ (ì¼ê´„ ë“±ë¡)</h3>

                    <div class="alert-info alert">
                        <span>ğŸ“ CSV í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ì‘ì„± í›„ ì—…ë¡œë“œí•˜ì„¸ìš”.</span>
                        <button class="btn btn-secondary" @click="downloadTemplate" style="margin-left: auto;">
                            ğŸ“¥ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>

                    <div class="upload-area" 
                         :class="{ dragover: isDragging }"
                         @click="$refs.fileInput.click()"
                         @dragover.prevent="isDragging = true"
                         @dragleave.prevent="isDragging = false"
                         @drop.prevent="handleFileDrop">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“‚</div>
                        <div style="font-size: 16px; font-weight: 600; color: #2c3e50; margin-bottom: 5px;">
                            í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ
                        </div>
                        <div style="font-size: 13px; color: #7f8c8d;">
                            CSV íŒŒì¼ë§Œ ì§€ì› (UTF-8 ì¸ì½”ë”©)
                        </div>
                        <input type="file" ref="fileInput" class="file-input" accept=".csv" @change="handleFileSelect">
                    </div>

                    <div v-if="csvData.length > 0" style="margin-top: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3>ì—…ë¡œë“œëœ ë°ì´í„° ({{ csvData.length }}ê°œ)</h3>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" @click="csvData = []">ì·¨ì†Œ</button>
                                <button class="btn btn-success" @click="saveBatchCSV" :disabled="loading">
                                    ğŸ’¾ {{ csvData.length }}ê°œ ì €ì¥
                                </button>
                            </div>
                        </div>

                        <div class="table-container">
                            <table class="csv-table">
                                <thead>
                                    <tr>
                                        <th>ì´ë¦„</th>
                                        <th>ë¶„ë¥˜</th>
                                        <th>ì£¼ì†Œ</th>
                                        <th>ì „í™”ë²ˆí˜¸</th>
                                        <th>í‰ì </th>
                                        <th>ë¦¬ë·°ìˆ˜</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(row, idx) in csvData" :key="idx">
                                        <td>{{ row.name }}</td>
                                        <td>{{ row.category || '-' }}</td>
                                        <td>{{ row.address || '-' }}</td>
                                        <td>{{ row.phone || '-' }}</td>
                                        <td>{{ row.rating || '-' }}</td>
                                        <td>{{ row.review_count || '-' }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div v-if="activeTab === 'direct'">
                    <h3 style="margin-bottom: 20px;">ë ˆìŠ¤í† ë‘ ì •ë³´ ì§ì ‘ ì…ë ¥</h3>

                    <div class="sub-tabs">
                        <button class="sub-tab" :class="{ active: directSubTab === 'basic' }" @click="directSubTab = 'basic'">
                            ê¸°ë³¸ì •ë³´
                        </button>
                        <button class="sub-tab" :class="{ active: directSubTab === 'details' }" @click="directSubTab = 'details'">
                            ìƒì„¸ì •ë³´
                        </button>
                        <button class="sub-tab" :class="{ active: directSubTab === 'menu' }" @click="directSubTab = 'menu'">
                            ë©”ë‰´
                        </button>
                        <button class="sub-tab" :class="{ active: directSubTab === 'hours' }" @click="directSubTab = 'hours'">
                            ì˜ì—…ì‹œê°„
                        </button>
                        <button class="sub-tab" :class="{ active: directSubTab === 'links' }" @click="directSubTab = 'links'">
                            ë§í¬/ì‹œì„¤
                        </button>
                    </div>

                    <div v-show="directSubTab === 'basic'">
                        <div class="form-group">
                            <label class="form-label">ë ˆìŠ¤í† ë‘ ì´ë¦„ <span class="required">*</span></label>
                            <input type="text" class="form-input" v-model="directForm.name" placeholder="ì˜ˆ: ì˜¬ë˜êµ­ìˆ˜">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì¹´í…Œê³ ë¦¬ <span class="required">*</span></label>
                                <select class="form-input" v-model="directForm.category">
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="í•œì‹">í•œì‹</option>
                                    <option value="ì¤‘ì‹">ì¤‘ì‹</option>
                                    <option value="ì¼ì‹">ì¼ì‹</option>
                                    <option value="ì–‘ì‹">ì–‘ì‹</option>
                                    <option value="ì¹´í˜/ë””ì €íŠ¸">ì¹´í˜/ë””ì €íŠ¸</option>
                                    <option value="í•´ì‚°ë¬¼">í•´ì‚°ë¬¼</option>
                                    <option value="ê³ ê¸°/êµ¬ì´">ê³ ê¸°/êµ¬ì´</option>
                                    <option value="ë¶„ì‹">ë¶„ì‹</option>
                                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">ê°€ê²©ëŒ€</label>
                                <select class="form-input" v-model="directForm.price_range">
                                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="ì €ê°€">ì €ê°€ (1ë§Œì› ì´í•˜)</option>
                                    <option value="ì¤‘ê°€">ì¤‘ê°€ (1-3ë§Œì›)</option>
                                    <option value="ê³ ê°€">ê³ ê°€ (3ë§Œì› ì´ìƒ)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ì£¼ì†Œ <span class="required">*</span></label>
                            <input type="text" class="form-input" v-model="directForm.address" placeholder="ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ì „í™”ë²ˆí˜¸</label>
                                <input type="text" class="form-input" v-model="directForm.phone" placeholder="02-1234-5678">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ì§€ì—­</label>
                                <input type="text" class="form-input" v-model="directForm.region" placeholder="ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">í‰ì  (1-5)</label>
                                <input type="number" step="0.1" min="0" max="5" class="form-input" v-model.number="directForm.rating" placeholder="4.5">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ë¦¬ë·° ìˆ˜</label>
                                <input type="number" class="form-input" v-model.number="directForm.review_count" placeholder="150">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">ìœ„ë„</label>
                                <input type="number" step="0.000001" class="form-input" v-model.number="directForm.latitude" placeholder="37.5665">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ê²½ë„</label>
                                <input type="number" step="0.000001" class="form-input" v-model.number="directForm.longitude" placeholder="126.9780">
                            </div>
                        </div>
                    </div>

                    <div v-show="directSubTab === 'details'">
                        <div class="form-group">
                            <label class="form-label">ì„¤ëª…</label>
                            <textarea class="form-input" v-model="directForm.description" rows="5" 
                                      placeholder="ë ˆìŠ¤í† ë‘ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ìµœëŒ€ 500ì)"></textarea>
                            <small style="color: #999; font-size: 12px;">{{ (directForm.description || '').length }} / 500ì</small>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ì¸ë„¤ì¼ URL</label>
                            <input type="text" class="form-input" v-model="directForm.thumbnail_url" placeholder="https://example.com/image.jpg">
                        </div>

                        <div class="form-group">
                            <label class="form-label">ì´ë¯¸ì§€ URL ëª©ë¡</label>
                            <div class="image-list">
                                <div class="image-item" v-for="(img, idx) in directForm.images" :key="idx">
                                    <input type="text" class="form-input" v-model="directForm.images[idx]" :placeholder="'ì´ë¯¸ì§€ ' + (idx + 1)">
                                    <button class="btn btn-secondary" @click="removeImage(idx)">ì‚­ì œ</button>
                                </div>
                                <button class="add-btn" @click="addImage" v-if="directForm.images.length < 10">â• ì´ë¯¸ì§€ ì¶”ê°€</button>
                            </div>
                            <small style="color: #999; font-size: 12px;">ìµœëŒ€ 10ê°œ</small>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">YouTube ì–¸ê¸‰ ìˆ˜</label>
                                <input type="number" min="0" class="form-input" v-model.number="directForm.youtube_mention_count" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ë¸”ë¡œê·¸ ì–¸ê¸‰ ìˆ˜</label>
                                <input type="number" min="0" class="form-input" v-model.number="directForm.blog_mention_count" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <div v-show="directSubTab === 'menu'">
                        <div class="form-group">
                            <label class="form-label">ë©”ë‰´ ëª©ë¡</label>
                            <div v-if="directForm.menu_items && directForm.menu_items.length > 0">
                                <div class="menu-item-card" v-for="(menu, idx) in directForm.menu_items" :key="idx">
                                    <button class="remove-btn" @click="removeMenu(idx)">Ã—</button>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">ë©”ë‰´ëª…</label>
                                            <input type="text" class="form-input" v-model="menu.name" placeholder="ì˜ˆ: ê¹€ì¹˜ì°Œê°œ">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">ê°€ê²© (ì›)</label>
                                            <input type="number" class="form-input" v-model.number="menu.price" placeholder="8000">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">ì„¤ëª… (ì„ íƒ)</label>
                                        <input type="text" class="form-input" v-model="menu.description" placeholder="ë©”ë‰´ ì„¤ëª…">
                                    </div>
                                </div>
                            </div>
                            <button class="add-btn" @click="addMenu">â• ë©”ë‰´ ì¶”ê°€</button>
                            <small v-if="!directForm.menu_items || directForm.menu_items.length === 0" style="color: #999; font-size: 12px; display: block; margin-top: 10px;">ë©”ë‰´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</small>
                        </div>
                    </div>

                    <div v-show="directSubTab === 'hours'">
                        <div class="form-group">
                            <label class="form-label">ì˜ì—…ì‹œê°„</label>
                            <div class="hour-item" v-for="day in weekDays" :key="day.value">
                                <div class="form-row">
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label class="form-label">{{ day.label }}</label>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <input 
                                                v-model="getHours(day.value).open" 
                                                type="time" 
                                                class="form-input"
                                                style="flex: 1;"
                                                :disabled="getHours(day.value).closed"
                                            >
                                            <span>~</span>
                                            <input 
                                                v-model="getHours(day.value).close" 
                                                type="time" 
                                                class="form-input"
                                                style="flex: 1;"
                                                :disabled="getHours(day.value).closed"
                                            >
                                            <label style="margin: 0; display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                                <input 
                                                    type="checkbox" 
                                                    v-model="getHours(day.value).closed"
                                                    @change="toggleClosed(day.value)"
                                                >
                                                íœ´ë¬´
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="add-btn" @click="applyToAll" style="margin-top: 15px;">ì›”ìš”ì¼ ì‹œê°„ì„ ì „ì²´ ì ìš©</button>
                        </div>
                    </div>

                    <div v-show="directSubTab === 'links'">
                        <div class="form-group">
                            <label class="form-label">í”Œë«í¼</label>
                            <select class="form-input" v-model="directForm.source">
                                <option value="manual">ìˆ˜ë™ ì…ë ¥</option>
                                <option value="naver">ë„¤ì´ë²„</option>
                                <option value="google">êµ¬ê¸€</option>
                            </select>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Google Place ID</label>
                                <input type="text" class="form-input" v-model="directForm.google_place_id" placeholder="ChIJ...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Naver Place ID</label>
                                <input type="text" class="form-input" v-model="directForm.naver_place_id" placeholder="1234567">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Google Maps URL</label>
                                <input type="text" class="form-input" v-model="directForm.google_maps_url" placeholder="https://maps.google.com/...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Naver Map URL</label>
                                <input type="text" class="form-input" v-model="directForm.naver_map_url" placeholder="https://map.naver.com/...">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">ì›ë³¸ URL</label>
                            <input type="text" class="form-input" v-model="directForm.source_url" placeholder="ì›ë³¸ í˜ì´ì§€ URL">
                        </div>

                        <div class="form-group">
                            <label class="form-label">í¸ì˜ì‹œì„¤</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.parking"> ğŸ…¿ï¸ ì£¼ì°¨
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.wifi"> ğŸ“¶ WiFi
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.reservation"> ğŸ“ ì˜ˆì•½
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.delivery"> ğŸ›µ ë°°ë‹¬
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.takeout"> ğŸ“¦ í¬ì¥
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.group"> ğŸ‘¥ ë‹¨ì²´ì„
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.kids"> ğŸ‘¶ ìœ ì•„ë™ë°˜
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.wheelchair"> â™¿ íœ ì²´ì–´
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" v-model="facilities.pet"> ğŸ• ë°˜ë ¤ë™ë¬¼
                                </label>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee;">
                        <button class="btn btn-secondary" @click="resetDirectForm">ì´ˆê¸°í™”</button>
                        <button class="btn btn-primary" @click="saveDirectInput" :disabled="!directForm.name || loading">
                            ğŸ’¾ ì €ì¥í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    activeTab: 'url',
                    directSubTab: 'basic',
                    loading: false,
                    alert: {
                        show: false,
                        type: 'alert-success',
                        message: ''
                    },
                    urlForm: {
                        url: ''
                    },
                    urlPreview: null,
                    csvData: [],
                    isDragging: false,
                    directForm: {
                        name: '',
                        category: '',
                        price_range: '',
                        address: '',
                        phone: '',
                        region: '',
                        latitude: null,
                        longitude: null,
                        rating: null,
                        review_count: null,
                        description: '',
                        thumbnail_url: '',
                        images: [],
                        youtube_mention_count: null,
                        blog_mention_count: null,
                        menu_items: [],
                        business_hours: {},
                        source: 'manual',
                        google_place_id: '',
                        naver_place_id: '',
                        google_maps_url: '',
                        naver_map_url: '',
                        source_url: ''
                    },
                    facilities: {
                        parking: false,
                        wifi: false,
                        reservation: false,
                        delivery: false,
                        takeout: false,
                        group: false,
                        kids: false,
                        wheelchair: false,
                        pet: false
                    },
                    weekDays: [
                        { label: 'ì›”ìš”ì¼', value: 'monday' },
                        { label: 'í™”ìš”ì¼', value: 'tuesday' },
                        { label: 'ìˆ˜ìš”ì¼', value: 'wednesday' },
                        { label: 'ëª©ìš”ì¼', value: 'thursday' },
                        { label: 'ê¸ˆìš”ì¼', value: 'friday' },
                        { label: 'í† ìš”ì¼', value: 'saturday' },
                        { label: 'ì¼ìš”ì¼', value: 'sunday' }
                    ]
                };
            },
            methods: {
                async parseURL() {
                    if (!this.urlForm.url) {
                        this.showAlert('error', 'URLì„ ì…ë ¥í•˜ì„¸ìš”.');
                        return;
                    }

                    this.loading = true;
                    try {
                        const response = await axios.post('/api/data-management/manual-input/parse-url', {
                            url: this.urlForm.url
                        });

                        if (response.data.success) {
                            this.urlPreview = response.data.preview;
                            this.showAlert('success', 'URL íŒŒì‹± ì™„ë£Œ! ì €ì¥í•˜ê¸° ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
                        }
                    } catch (error) {
                        this.showAlert('error', error.response?.data?.detail || 'URL íŒŒì‹± ì‹¤íŒ¨');
                        this.urlPreview = null;
                    } finally {
                        this.loading = false;
                    }
                },
                async saveFromURL() {
                    if (!this.urlPreview) return;

                    this.loading = true;
                    try {
                        const response = await axios.post('/api/data-management/manual-input/direct-input', {
                            name: this.urlPreview.name,
                            address: this.urlPreview.address,
                            source: this.urlPreview.source
                        });

                        if (response.data.success) {
                            this.showAlert('success', 'ë ˆìŠ¤í† ë‘ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
                            this.urlForm.url = '';
                            this.urlPreview = null;
                        }
                    } catch (error) {
                        this.showAlert('error', error.response?.data?.detail || 'ì €ì¥ ì‹¤íŒ¨');
                    } finally {
                        this.loading = false;
                    }
                },
                handleFileSelect(event) {
                    const file = event.target.files[0];
                    if (file) {
                        this.processCSVFile(file);
                    }
                },
                handleFileDrop(event) {
                    this.isDragging = false;
                    const file = event.dataTransfer.files[0];
                    if (file && file.name.endsWith('.csv')) {
                        this.processCSVFile(file);
                    } else {
                        this.showAlert('error', 'CSV íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    }
                },
                async processCSVFile(file) {
                    this.loading = true;
                    const formData = new FormData();
                    formData.append('file', file);

                    try {
                        const response = await axios.post('/api/data-management/manual-input/upload-csv', formData, {
                            headers: { 'Content-Type': 'multipart/form-data' }
                        });

                        if (response.data.success) {
                            this.csvData = response.data.data;
                            this.showAlert('success', response.data.message);
                        }
                    } catch (error) {
                        this.showAlert('error', error.response?.data?.detail || 'CSV íŒŒì¼ ì²˜ë¦¬ ì‹¤íŒ¨');
                    } finally {
                        this.loading = false;
                    }
                },
                async saveBatchCSV() {
                    if (this.csvData.length === 0) return;

                    this.loading = true;
                    try {
                        const response = await axios.post('/api/data-management/manual-input/batch-create-from-csv', this.csvData);

                        if (response.data.success) {
                            this.showAlert('success', response.data.message);
                            this.csvData = [];
                            this.$refs.fileInput.value = '';
                        }
                    } catch (error) {
                        this.showAlert('error', error.response?.data?.detail || 'ì¼ê´„ ì €ì¥ ì‹¤íŒ¨');
                    } finally {
                        this.loading = false;
                    }
                },
                async saveDirectInput() {
                    if (!this.directForm.name) {
                        this.showAlert('error', 'ë ˆìŠ¤í† ë‘ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');
                        return;
                    }

                    this.loading = true;
                    try {
                        const payload = {
                            ...this.directForm,
                            facilities: this.facilities
                        };

                        const response = await axios.post('/api/data-management/manual-input/direct-input', payload);

                        if (response.data.success) {
                            this.showAlert('success', 'ë ˆìŠ¤í† ë‘ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
                            this.resetDirectForm();
                        }
                    } catch (error) {
                        this.showAlert('error', error.response?.data?.detail || 'ì €ì¥ ì‹¤íŒ¨');
                    } finally {
                        this.loading = false;
                    }
                },
                resetDirectForm() {
                    this.directForm = {
                        name: '',
                        category: '',
                        price_range: '',
                        address: '',
                        phone: '',
                        region: '',
                        latitude: null,
                        longitude: null,
                        rating: null,
                        review_count: null,
                        description: '',
                        thumbnail_url: '',
                        images: [],
                        youtube_mention_count: null,
                        blog_mention_count: null,
                        menu_items: [],
                        business_hours: {},
                        source: 'manual',
                        google_place_id: '',
                        naver_place_id: '',
                        google_maps_url: '',
                        naver_map_url: '',
                        source_url: ''
                    };
                    this.facilities = {
                        parking: false,
                        wifi: false,
                        reservation: false,
                        delivery: false,
                        takeout: false,
                        group: false,
                        kids: false,
                        wheelchair: false,
                        pet: false
                    };
                    this.directSubTab = 'basic';
                },
                addMenu() {
                    if (!this.directForm.menu_items) {
                        this.directForm.menu_items = [];
                    }
                    this.directForm.menu_items.push({ name: '', price: null, description: '' });
                },
                removeMenu(index) {
                    this.directForm.menu_items.splice(index, 1);
                },
                addImage() {
                    if (!this.directForm.images) {
                        this.directForm.images = [];
                    }
                    if (this.directForm.images.length < 10) {
                        this.directForm.images.push('');
                    }
                },
                removeImage(index) {
                    this.directForm.images.splice(index, 1);
                },
                getHours(day) {
                    if (!this.directForm.business_hours) {
                        this.directForm.business_hours = {};
                    }
                    if (!this.directForm.business_hours[day]) {
                        this.directForm.business_hours[day] = { open: '09:00', close: '21:00', closed: false };
                    }
                    return this.directForm.business_hours[day];
                },
                toggleClosed(day) {
                    const hours = this.getHours(day);
                    if (hours.closed) {
                        hours.open = '';
                        hours.close = '';
                    } else {
                        hours.open = '09:00';
                        hours.close = '21:00';
                    }
                },
                applyToAll() {
                    const mondayHours = this.getHours('monday');
                    this.weekDays.forEach(day => {
                        if (day.value !== 'monday') {
                            this.directForm.business_hours[day.value] = {
                                open: mondayHours.open,
                                close: mondayHours.close,
                                closed: mondayHours.closed
                            };
                        }
                    });
                    this.showAlert('success', 'ì›”ìš”ì¼ ì‹œê°„ì´ ì „ì²´ ìš”ì¼ì— ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                async downloadTemplate() {
                    try {
                        const response = await axios.get('/api/data-management/manual-input/csv-template');
                        if (response.data.success) {
                            const template = response.data.template;
                            const headers = response.data.headers;
                            
                            let csv = headers.join(',') + '\n';
                            template.forEach(row => {
                                csv += headers.map(h => `"${row[h]}"`).join(',') + '\n';
                            });

                            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
                            const link = document.createElement('a');
                            link.href = URL.createObjectURL(blob);
                            link.download = 'restaurant_template.csv';
                            link.click();
                        }
                    } catch (error) {
                        this.showAlert('error', 'í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨');
                    }
                },
                showAlert(type, message) {
                    this.alert = {
                        show: true,
                        type: `alert-${type}`,
                        message: message
                    };
                    setTimeout(() => {
                        this.alert.show = false;
                    }, 5000);
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
